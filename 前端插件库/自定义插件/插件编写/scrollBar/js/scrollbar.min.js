
/**
 * @author wuwg
 * @version 2016.0.1
 * @description file
 * @createTime 2016/6/30
 * @updateTime 2016/9/20
 * @descrition  兼容ie7
 * @update  更新top设置为0时，内容出现负数的bug
 * @updateTime 2016/10/11
 * @update
 *问题修复：
 * 	1.解决因为内容变少之前，有滚动条，并且滚动条已经滚动到了其他位置（非0的位置），
 *   当更新的内容小于可视高度时，滚动条会隐藏，但是在此之前，内容已经被滚动过，这时top值无法还原的问题
 *功能增加：
 *  1.滚动后执行了回调函数功能，用户可以在执行完滚动后为其执行一个回调函数
 *  2.增加隐藏滚动条设置
 *  3.增加水平滚动条功能
  * @updateTime 2016/11/30
 *  1.ie8下滚动条无法用鼠标拖动，window修改为document对象
 */
+function(a,b){!function(){function j(c){var r,s,t,d=c||a.event,h=e.call(arguments,1),j=0,m=0,n=0,o=0,p=0,q=0;return c=b.event.fix(d),c.type="mousewheel","detail"in d&&(n=-1*d.detail),"wheelDelta"in d&&(n=d.wheelDelta),"wheelDeltaY"in d&&(n=d.wheelDeltaY),"wheelDeltaX"in d&&(m=-1*d.wheelDeltaX),"axis"in d&&d.axis===d.HORIZONTAL_AXIS&&(m=-1*n,n=0),j=0===n?m:n,"deltaY"in d&&(n=-1*d.deltaY,j=n),"deltaX"in d&&(m=d.deltaX,0===n&&(j=-1*m)),0!==n||0!==m?(1===d.deltaMode?(r=b.data(this,"mousewheel-line-height"),j*=r,n*=r,m*=r):2===d.deltaMode&&(s=b.data(this,"mousewheel-page-height"),j*=s,n*=s,m*=s),o=Math.max(Math.abs(n),Math.abs(m)),(!g||g>o)&&(g=o,l(d,o)&&(g/=40)),l(d,o)&&(j/=40,m/=40,n/=40),j=Math[j>=1?"floor":"ceil"](j/g),m=Math[m>=1?"floor":"ceil"](m/g),n=Math[n>=1?"floor":"ceil"](n/g),i.settings.normalizeOffset&&this.getBoundingClientRect&&(t=this.getBoundingClientRect(),p=c.clientX-t.left,q=c.clientY-t.top),c.deltaX=m,c.deltaY=n,c.deltaFactor=g,c.offsetX=p,c.offsetY=q,c.deltaMode=0,h.unshift(c,j,m,n),f&&clearTimeout(f),f=setTimeout(k,200),(b.event.dispatch||b.event.handle).apply(this,h)):void 0}function k(){g=null}function l(a,b){return i.settings.adjustOldDeltas&&"mousewheel"===a.type&&0===b%120}var f,g,h,i,c=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],d="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],e=Array.prototype.slice;if(b.event.fixHooks)for(h=c.length;h;)b.event.fixHooks[c[--h]]=b.event.mouseHooks;i=b.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var a=d.length;a;)this.addEventListener(d[--a],j,!1);else this.onmousewheel=j;b.data(this,"mousewheel-line-height",i.getLineHeight(this)),b.data(this,"mousewheel-page-height",i.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var a=d.length;a;)this.removeEventListener(d[--a],j,!1);else this.onmousewheel=null;b.removeData(this,"mousewheel-line-height"),b.removeData(this,"mousewheel-page-height")},getLineHeight:function(a){var c=b(a),d=c["offsetParent"in b.fn?"offsetParent":"parent"]();return d.length||(d=b("body")),parseInt(d.css("fontSize"),10)||parseInt(c.css("fontSize"),10)||16},getPageHeight:function(a){return b(a).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}},b.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})}()}(window,jQuery),+function(a,b){b.fn.addScrollBar=function(c){var e,d={};return d._this=b(this),e={version:"16.7.3",author:"wuwg",creatTime:"2016-07-06",updateTime:"2016-10-11",hasScrollBar:!0,direction:"vertical",scrollContentContainClass:"fd-scroll-content",scrollBarContainClass:"fd-scroll-track",scrollBarClass:"fd-scroll-bar",pressClass:"pressed",scrollBarMinHeight:5,scrollBarMinWidth:50,scrollStep:10,scrollTweenTime:10,hideScrollBar:!0,callback:null},d.opts=b.fn.extend(!0,e,c||{}),d.scrollBar={range:function(a,b,c){return Math.ceil(Math.min(b,Math.max(a,c)))},stopBubble:function(a){a.stopPropagation(),a.preventDefault()},createScrollBar:function(){var a=b('<div  class="'+d.opts.scrollBarContainClass+'">'+'<span class="'+d.opts.scrollBarClass+'"></span>'+"</div>");d.opts.hideScrollBar&&a.css({opacity:0}),a.appendTo(d.scrollBar.parentContain),d.scrollBar.trackContain=d.scrollBar.parentContain.children("."+d.opts.scrollBarContainClass),d.scrollBar.bar=d.scrollBar.trackContain.find("."+d.opts.scrollBarClass)},getParams:function(){var a,b;return"vertical"==d.opts.direction?(d.scrollBar.offsetHeight=d.scrollBar.parentContain.height(),d.scrollBar.scrollHeight=d.scrollBar.contentContain.innerHeight(),d.scrollBar.trackContainHeight=d.scrollBar.trackContain.innerHeight(),a=d.scrollBar.offsetHeight/d.scrollBar.scrollHeight*d.scrollBar.trackContainHeight,d.scrollBar.barHeight=Math.max(d.opts.scrollBarMinHeight,a),d.scrollBar.scrollMinDistance=0,d.scrollBar.scrollMaxDistance=d.scrollBar.trackContainHeight-d.scrollBar.barHeight,d.scrollBar.scrollAreaHeight=d.scrollBar.trackContainHeight-d.scrollBar.barHeight,d.scrollBar.bar.height(d.scrollBar.barHeight),d.scrollBar.offsetHeight>d.scrollBar.scrollHeight?(d.scrollBar.trackContain.css({display:"none"}),d.scrollBar.contentContain.css({top:0}),d.scrollBar.bar.css({top:0}),!1):(d.scrollBar.trackContain.css({display:"block"}),!0)):(d.scrollBar.offsetWidth=d.scrollBar.parentContain.width(),d.scrollBar.scrollWidth=d.scrollBar.contentContain.innerWidth(),d.scrollBar.trackContainWidth=d.scrollBar.trackContain.innerWidth(),b=d.scrollBar.offsetWidth/d.scrollBar.scrollWidth*d.scrollBar.trackContainWidth,d.scrollBar.barWidth=Math.max(d.opts.scrollBarMinWidth,b),d.scrollBar.scrollMinDistance=0,d.scrollBar.scrollMaxDistance=d.scrollBar.trackContainWidth-d.scrollBar.barWidth,d.scrollBar.scrollAreaWidth=d.scrollBar.trackContainWidth-d.scrollBar.barWidth,d.scrollBar.bar.width(d.scrollBar.barWidth),d.scrollBar.offsetWidth>d.scrollBar.scrollWidth?(d.scrollBar.trackContain.css({display:"none"}),d.scrollBar.contentContain.css({left:0}),d.scrollBar.bar.css({left:0}),!1):(d.scrollBar.trackContain.css({display:"block"}),!0))},update:function(a,c,e){var g,h,i,j,f=d.scrollBar.getParams();f&&("vertical"==d.opts.direction?(g="number"==b.type(c)?c:parseInt(d.scrollBar.contentContain.css("top"))?parseInt(d.scrollBar.contentContain.css("top")):0,g=Math.abs(g),d.scrollBar.scrollHeight-g<d.scrollBar.offsetHeight&&(g=d.scrollBar.scrollHeight-d.scrollBar.offsetHeight),h=g/(d.scrollBar.scrollHeight-d.scrollBar.offsetHeight),i="number"==b.type(a)?a:d.opts.scrollTweenTime,d.scrollBar.bar.stop(!0,!0).animate({top:d.scrollBar.scrollAreaHeight*h},i,function(){"function"==b.type(d.opts.callback)&&d.opts.callback(g),"function"==b.type(e)&&e(g)}),d.scrollBar.contentContain.stop(!0,!0).animate({top:-g},i)):(j="number"==b.type(c)?c:parseInt(d.scrollBar.contentContain.css("left"))?parseInt(d.scrollBar.contentContain.css("left")):0,j=Math.abs(j),d.scrollBar.scrollWidth-j<d.scrollBar.offsetWidth&&(g=d.scrollBar.scrollWidth-d.scrollBar.offsetWidth),h=j/(d.scrollBar.scrollWidth-d.scrollBar.offsetWidth),i="number"==b.type(a)?a:d.opts.scrollTweenTime,d.scrollBar.bar.stop(!0,!0).animate({left:d.scrollBar.scrollAreaWidth*h},i,function(){"function"==b.type(d.opts.callback)&&d.opts.callback(g),"function"==b.type(e)&&e(g)}),d.scrollBar.contentContain.stop(!0,!0).animate({left:-j},i)))},moveFunction:function(a){var e,f,g,h,i,c=d.scrollBar.draging?0:d.opts.scrollTweenTime;if("vertical"==d.opts.direction){if(e=""==parseInt(d.scrollBar.bar.css("top"))?0:parseInt(d.scrollBar.bar.css("top")),e+=Number(a),f=d.scrollBar.range(e,d.scrollBar.scrollMaxDistance,d.scrollBar.scrollMinDistance),g=f/d.scrollBar.scrollAreaHeight,d.scrollBar.bar.is(":animated")||d.scrollBar.contentContain.is(":animated"))return;d.scrollBar.bar.stop(!0,!0).animate({top:f},c,function(){"function"==b.type(d.opts.callback)&&d.opts.callback(-Math.round((d.scrollBar.scrollHeight-d.scrollBar.offsetHeight)*g))}),d.scrollBar.contentContain.stop(!0,!0).animate({top:-Math.round((d.scrollBar.scrollHeight-d.scrollBar.offsetHeight)*g)},c)}else{if(h=""==parseInt(d.scrollBar.bar.css("left"))?0:parseInt(d.scrollBar.bar.css("left")),h+=Number(a),i=d.scrollBar.range(h,d.scrollBar.scrollMaxDistance,d.scrollBar.scrollMinDistance),g=i/d.scrollBar.scrollAreaWidth,d.scrollBar.bar.is(":animated")||d.scrollBar.contentContain.is(":animated"))return;d.scrollBar.bar.stop(!0,!0).animate({left:i},c,function(){"function"==b.type(d.opts.callback)&&d.opts.callback(f)}),d.scrollBar.contentContain.stop(!0,!0).animate({left:-Math.round((d.scrollBar.scrollWidth-d.scrollBar.offsetWidth)*g)},c)}},mousewheel:function(a){var b,c;if(a=d.scrollBar.getEvent(a),d.scrollBar.stopBubble(a),"vertical"==d.opts.direction){if(d.scrollBar.scrollHeight<d.scrollBar.offsetHeight)return}else if(d.scrollBar.scrollWidth<d.scrollBar.offsetWidth)return;switch(b=a.deltaY,c=0,b){case 1:c=-1*d.opts.scrollStep,d.scrollBar.moveFunction(c);break;case-1:c=d.opts.scrollStep,d.scrollBar.moveFunction(c)}},getEvent:function(b){var b=b||a.event;return b},draging:!1,mousedown:function(c){var e,f,g,h;c=d.scrollBar.getEvent(c),e=b(this),d.scrollBar.draging=!0,f="vertical"==d.opts.direction?c.pageY:c.pageX,g=0,h=0,e.addClass(d.opts.pressClass),b(document).on("mousemove.scrollBar",function(b){var b=d.scrollBar.getEvent(b);d.scrollBar.stopBubble(b),h="vertical"==d.opts.direction?b.pageY:b.pageX,a.getSelection?a.getSelection().removeAllRanges():document.selection.empty(),g=h-f,f=h,d.scrollBar.moveFunction(g)}).on("mouseup.scrollBar",function(){b(document).off("mousemove.scrollBar"),b(document).off("mouseup.scrollBar"),d.scrollBar.draging=!1,e.removeClass(d.opts.pressClass)})},resize:function(){d.scrollBar.update(20)},bindEvent:function(){d.scrollBar.parentContain.off("mousewheel.scrollBar").on("mousewheel.scrollBar",d.scrollBar.mousewheel),d.scrollBar.parentContain.off("mousedown.scrollBar").on("mousedown.scrollBar","."+d.opts.scrollBarClass,d.scrollBar.mousedown),d.scrollBar.resizeEvent=d._this.attr("id")?"resize.scrollBar"+d._this.attr("id"):"resize.scrollBar",b(a).off(d.scrollBar.resizeEvent).on(d.scrollBar.resizeEvent,d.scrollBar.resize),d.opts.hideScrollBar&&(d.scrollBar.parentContain.off("mouseenter.scrollBar").on("mouseenter.scrollBar",function(){d.scrollBar.trackContain.stop(!0,!0).animate({opacity:1},400)}),d.scrollBar.parentContain.off("mouseleave.scrollBar").on("mouseleave.scrollBar",function(){d.scrollBar.trackContain.stop(!0,!0).animate({opacity:0},400)}))},unbindEvent:function(){d.scrollBar.parentContain.off("mousewheel.scrollBar",d.scrollBar.mousewheel),d.scrollBar.parentContain.off("mousedown.scrollBar","."+d.opts.scrollBarClass,d.scrollBar.mousedown),"resize.scrollBar"!=d.scrollBar.resizeEvent&&b(a).off(d.scrollBar.resizeEvent),d.scrollBar.parentContain.off("mouseenter.scrollBar").off("mouseleave.scrollBar")},init:function(){d.scrollBar.parentContain=d._this,d.scrollBar.parentContain.css({overflow:"hidden"}),d.scrollBar.contentContain=d.scrollBar.parentContain.children("."+d.opts.scrollContentContainClass),d.scrollBar.createScrollBar(),d.scrollBar.getParams(),d.scrollBar.bindEvent()},destory:function(){d.scrollBar.unbindEvent(),d.scrollBar.trackContain.remove()}},d.opts.hasScrollBar&&d.scrollBar.init(),d}}(window,jQuery);