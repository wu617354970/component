(function(B,A){B.fn.addPopup=function(E){var C=B.extend({},{box:"",closeBtn:".closeBtn",mouseType:"click",tweenTime:300,openHandler:function(){},closeHandler:function(){}},E||{});var F=B("<div id='mask_lay'></div>");F.css({"position":"absolute","left":0,"top":0,"opacity":0.5,"z-index":999,"display":"none","width":"100%","height":"100%","background-color":"#000000"});B(document.body).append(F);return this.each(function(){var G=B("#"+C.box);var I=false;if(B.browser.msie&&B.browser.version==6){I=true;G.css("position","absolute")}else{G.css("position","fixed")}B(this).bind(C.mouseType,function(){J();B(A).bind("resize",J)});G.find(C.closeBtn).click(function(){H();B(A).unbind("resize",J)});function J(){var M=D();var K=0,N=0,L=0;if(!I){N=(M.w-G.width())/2;K=(M.h-G.height())/2}else{N=(M.w-G.width())/2+M.l;K=(M.h-G.height())/2+M.t}L=Math.max(M.h,M.scrollH,0);F.css("height",L).css("z-index",1002).fadeIn(C.tweenTime,function(){G.css({left:N,top:K,"z-index":1003,"display":"block"}).show()});C.openHandler()}function H(){G.hide();F.fadeOut(C.tweenTime);C.closeHandler()}});function D(){var G=document.documentElement;return{w:(A.innerWidth)||(G&&G.clientWidth)||(document.body.clientWidth),h:(A.innerHeight)||(G&&G.clientHeight)||(document.body.clientHeight),l:(G&&G.scrollLeft)||(document.body.scrollLeft),t:(G&&G.scrollTop)||(document.body.scrollTop),scrollH:(G&&G.scrollHeight)||(document.body.scrollHeight)}}}})(jQuery,window);