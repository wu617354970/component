/**
 * @author wuwg
 * @version 2016.0.1
 * @description file
 * @createTime 2016/6/30
 * @updateTime 2017/1/03
 * @descrition  兼容ie7
 */
+function(a,b){
/*! Copyright (c) 2013 Brandon Aaron (http://brandon.aaron.sh)
     * Licensed under the MIT License (LICENSE.txt).
     *
     * Version: 3.1.12
     *
     * Requires: jQuery 1.2.2+
     */
(function(c){if(typeof define==="function"&&define.amd){define(["jquery"],c)}else{if(typeof exports==="object"){module.exports=c}else{c(jQuery)}}}(function(e){var f=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],m=("onwheel" in document||document.documentMode>=9)?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],k=Array.prototype.slice,l,d;if(e.event.fixHooks){for(var g=f.length;g;){e.event.fixHooks[f[--g]]=e.event.mouseHooks}}var h=e.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener){for(var o=m.length;o;){this.addEventListener(m[--o],n,false)}}else{this.onmousewheel=n}e.data(this,"mousewheel-line-height",h.getLineHeight(this));e.data(this,"mousewheel-page-height",h.getPageHeight(this))},teardown:function(){if(this.removeEventListener){for(var o=m.length;o;){this.removeEventListener(m[--o],n,false)}}else{this.onmousewheel=null}e.removeData(this,"mousewheel-line-height");e.removeData(this,"mousewheel-page-height")},getLineHeight:function(o){var i=e(o),p=i["offsetParent" in e.fn?"offsetParent":"parent"]();if(!p.length){p=e("body")}return parseInt(p.css("fontSize"),10)||parseInt(i.css("fontSize"),10)||16},getPageHeight:function(i){return e(i).height()},settings:{adjustOldDeltas:true,normalizeOffset:true}};e.fn.extend({mousewheel:function(i){return i?this.bind("mousewheel",i):this.trigger("mousewheel")},unmousewheel:function(i){return this.unbind("mousewheel",i)}});function n(i){var q=i||a.event,w=k.call(arguments,1),y=0,s=0,r=0,v=0,u=0,t=0;i=e.event.fix(q);i.type="mousewheel";if("detail" in q){r=q.detail*-1}if("wheelDelta" in q){r=q.wheelDelta}if("wheelDeltaY" in q){r=q.wheelDeltaY}if("wheelDeltaX" in q){s=q.wheelDeltaX*-1}if("axis" in q&&q.axis===q.HORIZONTAL_AXIS){s=r*-1;r=0}y=r===0?s:r;if("deltaY" in q){r=q.deltaY*-1;y=r}if("deltaX" in q){s=q.deltaX;if(r===0){y=s*-1}}if(r===0&&s===0){return}if(q.deltaMode===1){var x=e.data(this,"mousewheel-line-height");y*=x;r*=x;s*=x}else{if(q.deltaMode===2){var p=e.data(this,"mousewheel-page-height");y*=p;r*=p;s*=p}}v=Math.max(Math.abs(r),Math.abs(s));if(!d||v<d){d=v;if(c(q,v)){d/=40}}if(c(q,v)){y/=40;s/=40;r/=40}y=Math[y>=1?"floor":"ceil"](y/d);s=Math[s>=1?"floor":"ceil"](s/d);r=Math[r>=1?"floor":"ceil"](r/d);if(h.settings.normalizeOffset&&this.getBoundingClientRect){var o=this.getBoundingClientRect();u=i.clientX-o.left;t=i.clientY-o.top}i.deltaX=s;i.deltaY=r;i.deltaFactor=d;i.offsetX=u;i.offsetY=t;i.deltaMode=0;w.unshift(i,y,s,r);if(l){clearTimeout(l)}l=setTimeout(j,200);return(e.event.dispatch||e.event.handle).apply(this,w)}function j(){d=null}function c(o,i){return h.settings.adjustOldDeltas&&o.type==="mousewheel"&&i%120===0}}))}(window,jQuery);+function(a,b){b.fn.addTree=function(h){var c={};var f={showLog:false,key:"mapId",parentKey:"pId",name:"xqmc",childKey:"children",data:[],cache:false,cacheId:"wTreeLocalStorage",itemIdPrefix:"fd-tree-",operateItemClass:".tree-name",selectedIndex:0,selectedIsTriggerCallback:false,goToTargetClass:"tree-hd-warning",selectedClass:"tree-hd-selected",disabledClass:"disabled",hoverClass:"tree-hd-hover",hideTrigerClass:"hide",collapseClass:"tree-hd-collapse",nodeNameClass:"tree-name",checkboxClass:"fd-checkbox",checkedClass:"fd-checked",treeContentClass:"ul-tree-ct",itemClass:"tree-item",itemHeadClass:"tree-hd",triggerClass:"fd-trigger",extendArea:false,tweenTime:300,collapseChildren:true,defaultCollapse:true,defaultExpandIndex:0,hasAnimate:true,hasCheckbox:false,hasIcon:true,type:2,lastItemClass:"tree-item-last",allowAppendNewNode:true,canSelected:true,hasHoverEffect:true,onlyExpandOneLevel:true,hasTips:false,tipsTriggerElement:".tree-name",canSearch:false,searchKey:["id","mapId"],searchName:["mc","xqmc","tsmc","rymc"],searchScrollTweenTime:400,searchInput:"#jsSearch",searchButton:"#jsBtnSearch",limitCount:5,deferTime:200,isAutocompleter:true,hideAutocompleterClass:"hide",menuSelectedClass:"selected",autocompleterContain:"#jsAutocompleter",treeContain:"#jsTreeContain",autocompleterIsAjax:false,autocompleterAjax:{url:"json/search.json",method:"get",data:"nr",dataType:"json",asych:true,success:function(k,j,l){console.log("成功")},error:function(k,j,l){console.log("失败")}},hasScrollBar:true,scrollBarContain:".fd-scroll-track",scrollBarClass:"fd-scroll-bar",pressClass:"pressed",scrollBarMinHeight:50,scrollStep:10,scrollTweenTime:10,callback:{appendNewNode:function(n,l,m,j){var k=n.data("mapid");b.ajax({url:"json/ry.json",dataType:"json",data:k,method:"get",cache:false,crossDomain:false,timeout:2000,async:false,success:function(q){var o=q.result.dataList;var r=parseInt(n.attr("level"))+1;var p=j.view.appendNodes(o,r,0,[{key:"tsid",name:"tsmc",childKey:"ryList",collapseChildren:true,className:"tree-ts",allowAppendNewNode:false,canSelected:false,hasHoverEffect:false,hasTips:false},{key:"ryid",name:"rymc",childKey:"",collapseChildren:true,className:"tree-ts",allowAppendNewNode:false,canSelected:false,hasHoverEffect:false,hasTips:false}]);n.siblings("."+j.opts.treeContentClass)[0].innerHTML=p}})},tips:function(m,k,l,j){},onMouseenter:function(m,k,l,j){},onMouseleave:function(m,k,l,j){},onMmousemove:function(m,k,l,j){},onNodeCreated:function(){console.log("节点被创建的事件")},onClick:function(m,k,l,j){console.log("点击事件")},onDblClick:function(m,k,l,j){console.log("双击事件")},onMouseDown:function(m,k,l,j){console.log("鼠标按下事件")},onMouseUp:function(){console.log("鼠标按松开事件")},onExpand:function(m,k,l,j){console.log("展开的回调函数");j.scrollBar.update(20)},onCollapse:function(m,k,l,j){console.log("收起的回调函数");j.scrollBar.update(20)},onDestory:function(){console.log("销毁的回调函数")},checked:function(m,k,l,j){console.log("阻止冒泡");console.log(l);console.log(j)},unchecked:function(m,k,l,j){console.log("阻止冒泡uncheck");console.log(l)},search:function(m,n,o,j,l){var k=b("#"+j.opts.itemIdPrefix+m);if(k.size()<1){var p=b("#"+j.opts.itemIdPrefix+l.fyid);if(p.size()>0){if(j.opts.allowAppendNewNode){if(j.opts.showLog){console.log("不存在了，需要添加节点")}j.opts.callback.appendNewNode(p,n,o,j)}}}else{if(j.opts.showLog){console.log("自己玩去吧，已经存在了")}}},selected:function(k,j){var l=c._this.find(c.opts.operateItemClass).eq(k);if(l.size()>0){var m=c._this.find("."+c.opts.selectedClass);if(m.size()>0){m.removeClass(c.opts.selectedClass)}l.addClass(c.opts.selectedClass);if(!!j){l.trigger("click.tree")}}}}};c.opts=b.extend(true,{},f,h||{});c._this=b(this);c.cacheId=c.opts.cacheId+c._this.attr("id");var e=a.navigator.appVersion.toUpperCase();if(e.indexOf("MSIE")){var i=e.indexOf("MSIE");var d=e.indexOf(";",i+4);var g=parseInt(e.substring(i+4,d));if(g<8){c.opts.tweenTime=10}}c.init=function(){c.view.createTree();c.bindEvent.normal();c.defaultExpand();if(c.opts.hasTips){c.createTipsBox()}return c};c.update=function(j){c.opts.data=j;c.view.createTree();c.defaultExpand();if(c.opts.hasScrollBar){setTimeout(function(){c.scrollBar.update(20)},100)}};c.defaultSelected=function(j,k){if(b.type(j)==="number"){if(b.type(k)==="boolean"){c.opts.callback.selected(j,k)}else{c.opts.callback.selected(j)}}};c.setWhatItemCanSelected=function(j,l){if(b.type(j)==="number"){var k=false;if(b.type(l)==="boolean"){k=l}if(k){c._this.find("."+c.opts.itemHeadClass).each(function(){var o=b(this);var m=parseInt(o.attr("level"));var n=o.attr("canselected");if(m>j){b(this).attr("canselected","false")}else{if(n!=="false"){b(this).attr("canselected","true")}}})}else{c._this.find("."+c.opts.itemHeadClass).each(function(){var n=b(this);var m=n.attr("level");if(m>j){n.attr("canselected","false")}})}}};c.createTipsBox=function(){c.tipsBox=b("<div></div>").css({position:"absolute",top:"0",left:"0","white-space":"nowrap",font:'14px/1.4em "Microsoft YaHei"',"box-shadow":"0 0 4px 1px rgba(46, 139, 147, 0.5)",background:"rgba(9, 51, 101, 0.8)","z-index":"99",padding:"5px 10px",display:"none",color:"#fff","border-radius":"3px"});c.tipsBox.appendTo("body")};c.data={transformTozTreeFormat:function(r){var p,m,o=c.opts.key,n=c.opts.parentKey,q=c.opts.childKey;if(!o||o==""||!r){return[]}if(b.isArray(r)){var j=[];var k={};(function(){for(var t=0,s=r.length;t<s;t++){k[r[t][o]]=r[t]}t=null;s=null})();(function(){for(p=0,m=r.length;p<m;p++){if(k[r[p][n]]&&r[p][o]!=r[p][n]){if(!k[r[p][n]][q]){k[r[p][n]][q]=[]}k[r[p][n]][q].push(r[p])}else{j.push(r[p])}}})();return j}else{return[r]}}};c.view={createTree:function(){var j="";if(c.opts.cache){if(a.localStorage.getItem(c.cacheId)){j=a.localStorage.getItem(c.cacheId);c.opts.data=JSON.parse(a.localStorage.getItem(c.cacheId+"data"))}else{c.opts.data=c.data.transformTozTreeFormat(c.opts.data);j=c.view.appendNodes(c.opts.data,1);a.localStorage.setItem(c.cacheId,j);a.localStorage.setItem(c.cacheId+"data",JSON.stringify(c.opts.data))}}else{c.opts.data=c.data.transformTozTreeFormat(c.opts.data);j=c.view.appendNodes(c.opts.data,1)}c._this[0].innerHTML=j;return c},appendNodes:function(s,k,w,m){if(!s){return[]}var q=[];var B=c.opts.key;var p=c.opts.childKey;var o=c.opts.allowAppendNewNode;var r=c.opts.collapseChildren;var C=c.opts.name;var y=c.opts.canSelected;var j=c.opts.hasHoverEffect;var n="";var z=c.opts.hasTips;if(b.type(w)==="number"&&b.type(m)==="array"){var w=w;B=m[w].key?m[w].key:B;p=m[w].childKey?m[w].childKey:p;if(m[w].allowAppendNewNode!=="undefined"){o=m[w].allowAppendNewNode}C=m[w].name?m[w].name:C;if(m[w].collapseChildren!=="undefined"){r=m[w].collapseChildren}if(m[w].canSelected!=="undefined"){y=m[w].canSelected}if(m[w].hasHoverEffect!=="undefined"){j=m[w].hasHoverEffect}n=m[w].className?m[w].className+"-"+w:n;if(m[w].hasTips!=="undefined"){z=m[w].hasTips}}for(var v=0,u=s.length;v<u;v++){var t=s[v];var A=[];var x=false;if(t[p]&&t[p].length>0){x=true;A=c.view.appendNodes(t[p],k+1,w+1,m)}c.view.makeDOMNodeMainBefore(q,k,v,u);c.view.makeDOMNodeNameBefore(q,t,k,B,p,r,o,n,y,j,z);c.view.makeDOMNodeTrigger(q,x,o);c.view.makeDOMNodeABefore(q,t);c.view.makeDOMNodeIcon(q);c.view.makeDOMNodeCheckbox(q);c.view.makeDOMNodeAAfter(q,t,C);c.view.makeDOMNodeNameAfter(q);c.view.makeUlHtml(q,A,k,x,r,n);c.view.makeDOMNodeMainAfter(q)}return q.join("")},makeDOMNodeMainBefore:function(m,o,k,j){var n=false;if(c.opts.type===2){if((k+1)===j){n=true}m.push('<li   class="'+c.opts.itemClass+" "+(n?c.opts.lastItemClass:"")+"  tree-item-0"+o+'"   >')}else{m.push('<li   class="'+c.opts.itemClass+"  tree-item-0"+o+'"   >')}},makeDOMNodeNameBefore:function(o,m,j,v,l,q,u,r,t,n,k){var p=[];var u=u;var q=q;var t=t;if(typeof m.canSelected!="undefined"){t=m.canSelected}var k=k;for(name in m){if(m[name]===""){m[name]="false"}if(name!==l){p.push("data-"+name+"="+m[name])}}var s=c.opts.itemHeadClass+" "+(!!m.disabled?c.opts.disabledClass:"")+" tree-hd-0"+j;if(q){s=s+" "+c.opts.collapseClass}if(!!r){s=s+" "+r}o.push(' <h3 hastips="'+k+'" canselected="'+t+'"  hover="'+n+'"   allowAppendNewNode="'+u+'"  level="'+j+'"    '+p.join(" ")+'  id="'+c.opts.itemIdPrefix+m[v]+'"  class="'+s+'"> ')},makeDOMNodeTrigger:function(j,m,l){var k=c.opts.triggerClass;if(!m&&!l){k=c.opts.triggerClass+" "+c.opts.hideTrigerClass}j.push(' <span class="'+k+'"></span>')},makeDOMNodeABefore:function(j,k){if(!!k.url){j.push(' <a href="'+k.url+'" hidefocus="true"  class="'+c.opts.nodeNameClass+'"  >')}else{j.push(' <a href="javascript:void(0);" hidefocus="true"  class="'+c.opts.nodeNameClass+'"  >')}},makeDOMNodeIcon:function(j){if(c.opts.hasIcon){j.push('<span class="fd-icon"  title="图标容器"></span>')}},makeDOMNodeCheckbox:function(j){if(c.opts.hasCheckbox){j.push('<span class="'+c.opts.checkboxClass+'"><input type="checkbox" name=""     /><span  class="fd-input-checkbox"></span></span>')}},makeDOMNodeAAfter:function(k,l,j){k.push(l[j]+"</a>")},makeDOMNodeNameAfter:function(j){j.push("</h3>")},makeUlHtml:function(k,j,q,n,p,o){var m="";if(p){m="style=display:none;"}var l=c.opts.treeContentClass+" ul-tree-ct-0"+q;if(o){l=l+" "+o}if(n){k.push(" <ul "+m+'  class="'+l+' ">'+j+"</ul>")}else{k.push(" <ul "+m+'   class="'+l+'"></ul>')}},makeDOMNodeMainAfter:function(j){j.push("</li>")}};c.destory=function(){c.unbindEvent.allEvent();c.html("")};c.animate=function(k,m,l,p,n,o,j){if(l.is(":animated")){return false}if(!j.opts.hasAnimate){j.opts.tweenTime=0}if(k){m.removeClass(j.opts.collapseClass);if(j.opts.onlyExpandOneLevel){l.parent().siblings().each(function(){var s=b(this);var q=s.children("."+j.opts.itemHeadClass);var r=q.hasClass(j.opts.collapseClass);if(!r){q.addClass(j.opts.collapseClass).next("."+j.opts.treeContentClass).slideUp(j.opts.tweenTime)}})}l.stop(true,true).slideDown(j.opts.tweenTime,function(){if(b.type(j.opts.callback.onExpand)==="function"){j.opts.callback.onExpand(p,n,o,j)}})}else{m.addClass(j.opts.collapseClass);l.stop(true,true).slideUp(j.opts.tweenTime/j.opts.tweenTime,function(){if(b.type(j.opts.callback.onCollapse)==="function"){j.opts.callback.onCollapse(p,n,o,j)}})}};c.bindEvent={getTarget:function(j){var j=j||a.event;var k=b(j.target);return k},stopBubble:function(j){j.stopPropagation()},normal:function(){c.bindEvent.mouseenter();c.bindEvent.mouseleave();c.bindEvent.click();c.bindEvent.toggleChecked();c.bindEvent.toggleSlide();if(c.opts.hasTips){c.bindEvent.mouseenter();c.bindEvent.mouseleave();c.bindEvent.mousemove()}},all:function(){c.bindEvent.mouseenter();c.bindEvent.mouseleave();c.bindEvent.mousemove();c.bindEvent.click();c.bindEvent.dblclick();c.bindEvent.mouseDown();c.bindEvent.mouseUp();c.bindEvent.toggleChecked();c.bindEvent.toggleSlide()},mouseenter:function(){c._this.off("mouseenter.tree").on("mouseenter.tree","."+c.opts.itemHeadClass,function(k){var n=b(this);var k=k||a.event;var l=c.bindEvent.getTarget(k);if(n.attr("hover")==="true"){n.addClass(c.opts.hoverClass);if(b.type(c.opts.callback.onMouseenter)==="function"){c.opts.callback.onMouseenter(n,k,l,c)}}if(n.attr("hastips")==="true"){if(l.is(c.opts.tipsTriggerElement)){var m=k.pageY;var j=k.pageX;c.tipsBox.text(n.find("a").text()).css({top:m,left:j+20,display:"block"});if(b.type(c.opts.callback.tips)==="function"){c.opts.callback.tips(n,k,l,c)}}}})},mouseleave:function(){c._this.off("mouseleave.tree").on("mouseleave.tree","."+c.opts.itemHeadClass,function(j){var l=b(this);if(l.hasClass(c.opts.hoverClass)){l.removeClass(c.opts.hoverClass)}if(l.attr("hastips")==="true"){if(c.tipsBox.is(":visible")){c.tipsBox.css({display:"none"})}}var k=c.bindEvent.getTarget(j);if(b.type(c.opts.callback.onMouseleave)==="function"){c.opts.callback.onMouseleave(l,j,k,c)}})},mousemove:function(){c._this.off("mousemove.tree").on("mousemove.tree","."+c.opts.itemHeadClass,function(k){var n=b(this);var l=c.bindEvent.getTarget(k);var k=k||a.event;if(n.attr("hastips")==="true"){var m=k.pageY;var j=k.pageX;if(l.is(c.opts.tipsTriggerElement)){if(c.tipsBox.is(":hidden")){c.tipsBox.css({display:"block"})}c.tipsBox.css({top:m,left:j+20})}else{if(c.tipsBox.is(":visible")){c.tipsBox.css({display:"none"})}}}if(b.type(c.opts.callback.onMouseleave)==="function"){c.opts.callback.onMmousemove(n,k,l,c)}})},click:function(){c._this.off("click.tree").on("click.tree",c.opts.operateItemClass,function(k){var o=b(this);var m=o.closest("."+c.opts.itemHeadClass);var l=c.bindEvent.getTarget(k);var n=l.is("."+c.opts.triggerClass);if(n&&!c.opts.extendArea){if(c.opts.showLog){console.log("_scope.opts.extendArea为false,点击fd-trigger元素阻止默认事件")}return}else{var j=c._this.find("."+c.opts.goToTargetClass);if(j.size()>0){j.removeClass(c.opts.goToTargetClass)}if(m.attr("canselected")==="true"){if(!m.hasClass(c.opts.selectedClass)){c._this.find("."+c.opts.selectedClass).removeClass(c.opts.selectedClass);m.addClass(c.opts.selectedClass);if(b.type(c.opts.callback.onClick)==="function"){c.opts.callback.onClick(o,k,l,c)}if(c.opts.showLog){console.log("点击"+c.opts.operateItemClass+",该条数据增加选中状态，执行click函数；")}}else{if(c.opts.showLog){console.log("点击"+c.opts.operateItemClass+",该条数据已经是选中状态，无需执行click函数；")}}}}})},dblclick:function(){c._this.off("dblclick.tree").on("dblclick.tree",c.opts.operateItemClass,function(j){var l=b(this);var k=c.bindEvent.getTarget(j);if(b.type(c.opts.callback.onDblClick)==="function"){c.opts.callback.onDblClick(l,j,k,c)}})},mouseDown:function(){c._this.off("mousedown.tree").on("mousedown.tree",c.opts.operateItemClass,function(j){var l=b(this);var k=c.bindEvent.getTarget(j);if(b.type(c.opts.callback.onMouseDown)==="function"){c.opts.callback.onMouseDown(l,j,k,c)}})},mouseUp:function(){c._this.off("mouseup.tree").on("mouseup.tree",c.opts.operateItemClass,function(j){var l=b(this);var k=c.bindEvent.getTarget(j);if(b.type(c.opts.callback.onMouseUp)==="function"){c.opts.callback.onMouseUp(l,j,k,c)}})},toggleChecked:function(){if(c.opts.hasCheckbox){c._this.off("click.toggleChecked").on("click.toggleChecked","."+c.opts.checkboxClass,function(j){var n=b(this);var l=c.bindEvent.getTarget(j);var k=n.find(":checkbox");var m=l.closest("."+c.opts.checkboxClass);c.bindEvent.stopBubble(j);if(m.closest("."+c.opts.itemHeadClass).hasClass(c.opts.disabledClass)){j.preventDefault();return}if(!l.is("input:checkbox")){k.prop("checked",!k.prop("checked"))}if(!k.prop("checked")){m.removeClass(c.opts.checkedClass);if(b.type(c.opts.callback.unchecked)==="function"){c.opts.callback.unchecked(n,j,l,c);if(c.opts.showLog){console.log("点击"+c.opts.checkboxClass+",有选中类名"+c.opts.checkedClass+"取消选中，那么执行unchecked函数；")}}}else{m.addClass(c.opts.checkedClass);if(b.type(c.opts.callback.checked)==="function"){c.opts.callback.checked(n,j,l,c);if(c.opts.showLog){console.log("点击"+c.opts.checkboxClass+",没有选中类名"+c.opts.checkedClass+"选中checkbox，那么执行checked函数；")}}}})}},toggleSlide:function(){c._this.off("click.toggleSlide").on("click.toggleSlide","."+c.opts.itemHeadClass,function(l){var p=b(this);var n=c.bindEvent.getTarget(l);var o=n.closest("."+c.opts.itemHeadClass);var j=o.hasClass(c.opts.collapseClass);var m=o.next("."+c.opts.treeContentClass);var k=b.trim(m.text())===""?true:false;if(o.hasClass(c.opts.disabledClass)){return}if(k){if(c.opts.allowAppendNewNode){if(c.opts.extendArea){if(b.type(c.opts.callback.appendNewNode)==="function"){console.log("extend");c.opts.callback.appendNewNode(p,l,n,c)}}else{if(n.is("."+c.opts.triggerClass)){if(b.type(c.opts.callback.appendNewNode)==="function"){c.opts.callback.appendNewNode(p,l,n,c)}}}}else{if(c.opts.showLog){console.log("click.toggleSlide事件，没有子元素直接返回！")}return}}if(c.opts.extendArea){c.animate(j,o,m,p,l,n,c);if(c.opts.showLog){console.log("click.toggleSlide事件，有子元素，是扩大区域，点击整条都能执行动画有效")}}else{if(n.is("."+c.opts.triggerClass)){c.animate(j,o,m,p,l,n,c);if(c.opts.showLog){console.log("click.toggleSlide事件，有子元素，不是扩大区域，点击trigger元素才能执行动画")}}}})}};c.unbindEvent={mouseenter:function(){c._this.off("mouseenter.tree")},mouseleave:function(){c._this.off("mouseleave.tree")},click:function(){c._this.off("click.tree")},dblclick:function(){c._this.off("dblclick.tree")},mouseDown:function(){c._this.off("mouseDown.tree")},mouseUp:function(){c._this.off("mouseUp.tree")},toggleChecked:function(){c._this.off("click.toggleChecked")},toggleSlide:function(){c._this.off("click.toggleSlide")},all:function(){c.unbindEvent.mouseenter();c.unbindEvent.mouseleave();c.unbindEvent.click();c.unbindEvent.dblclick();c.unbindEvent.mouseDown();c.unbindEvent.mouseUp();c.unbindEvent.toggleChecked();c.unbindEvent.toggleSlide()},normal:function(){c.unbindEvent.mouseenter();c.unbindEvent.mouseleave();c.unbindEvent.click();c.unbindEvent.toggleChecked();c.unbindEvent.toggleSlide()}};c.defaultExpand=function(){if(typeof c.opts.defaultExpandIndex==="number"){c._this.children().eq(c.opts.defaultExpandIndex).children("."+c.opts.itemHeadClass).removeClass(c.opts.collapseClass).next("."+c.opts.treeContentClass).css("display","block")}};c.search={searchButton:b(c.opts.searchButton),searchInput:b(c.opts.searchInput),treeContain:b(c.opts.treeContain),autocompleterContain:b(c.opts.autocompleterContain),goToTarget:function(k){var j=b("#"+c.opts.itemIdPrefix+k);c._this.find("."+c.opts.goToTargetClass).removeClass(c.opts.goToTargetClass);j.addClass(c.opts.goToTargetClass);j.parents("."+c.opts.treeContentClass).each(function(){var m=b(this);var n=m.siblings("."+c.opts.itemHeadClass);if(n.hasClass(c.opts.collapseClass)){n.removeClass(c.opts.collapseClass)}if(m.is(":hidden")){m.show()}});var l=j.position().top;if(!c.opts.hasScrollBar){c.search.treeContain.stop(true,true).animate({scrollTop:l},c.opts.searchScrollTweenTime)}else{c.scrollBar.update(c.opts.searchScrollTweenTime,l)}},callback:{search:function(p,s){var n=c.search.searchInput.data();var o="";for(var m=0,l=c.opts.searchKey.length;m<l;m++){if(!!n[c.opts.searchKey[m]]){o=n[c.opts.searchKey[m]];break}}if(b.type(c.opts.callback.search)==="function"&&o!==""){c.opts.callback.search(o,p,s,c,n)}if(!!o){c.search.goToTarget(o);c.search.searchInput.trigger("blur.autocompleter")}else{var q=b.trim(c.search.searchInput.val());if(q!==""){var r=true;b.each(c.autocompleter.response,function(k,t){var j="";(function(){for(var v=0,u=c.opts.searchName.length;v<u;v++){if(!!t[c.opts.searchName[v]]){j=c.opts.searchName[v];break}}})();(function(){if(t[j]===q){c.search.searchInput.data(t);r=false;n=t;for(var v=0,u=c.opts.searchKey.length;v<u;v++){if(!!n[c.opts.searchKey[v]]){o=n[c.opts.searchKey[v]];break}}if(b.type(c.opts.callback.search)==="function"){c.opts.callback.search(o,p,s,c,n)}c.search.goToTarget(o);c.search.searchInput.trigger("blur.autocompleter");return false}})()});if(r){c.search.searchInput.focus()}}else{c.search.searchInput.focus()}}}}};c.autocompleter={timer:null,response:[],copyValueToSearch:function(q){var l=!!q?q:c.search.autocompleterContain.find("."+c.opts.menuSelectedClass);if(l.size()>0){var o=l.data();c.search.searchInput.removeData();c.search.searchInput.data(o);var p="";for(var n=0,m=c.opts.searchName.length;n<m;n++){if(!!o[c.opts.searchName[n]]){p=o[c.opts.searchName[n]];break}}c.search.searchInput.val(p);c.autocompleter.hideAutocompleter()}},hideAutocompleter:function(){b(c.search.autocompleterContain).addClass(c.opts.hideAutocompleterClass)},showAutocompleter:function(){b(c.search.autocompleterContain).removeClass(c.opts.hideAutocompleterClass)},query:function(p,m,k,q){if(!q){var m=m,k=k;if(c.autocompleter.response.length>=k){return false}for(var n=0,j=m.length;n<j;n++){var o=m[n];if(o[c.opts.name].search(p)!==-1){c.autocompleter.response.push(o)}if(o[c.opts.childKey]&&o[c.opts.childKey].length>0){c.autocompleter.query(p,o[c.opts.childKey],k)}if(c.autocompleter.response.length>=k){break;return c.autocompleter.response}}}else{if(c.opts.showLog){console.log("发送到后台的数据是：");console.log({param:JSON.parse('{"'+c.opts.autocompleterAjax.data+'":"'+p+'"}')});console.log("\n")}b.ajax({url:c.opts.autocompleterAjax.url,method:c.opts.autocompleterAjax.method,dataType:c.opts.autocompleterAjax.dataType,data:{param:'{"'+c.opts.autocompleterAjax.data+'":"'+p+'"}'},success:function(r,l,s){if(c.opts.showLog){console.log("后台返回的数据是：");console.log(r);console.log("\n")}if(b.type(r.result)==="array"){if(r.result.length>0){c.autocompleter.response=r.result;if(r.result.length>k){c.autocompleter.response=c.autocompleter.response.slice(0,k)}}}else{c.autocompleter.response=[]}c.autocompleter.makeList(p);if(b.type(c.opts.autocompleterAjax.success)==="function"){c.opts.autocompleterAjax.success(r,l,s,c)}},error:function(r,l,s){if(b.type(c.opts.autocompleterAjax.error)==="function"){c.opts.autocompleterAjax.error(r,l,s,c)}}})}},makeList:function(v){var p=c.autocompleter.response.length;if(p>0){var u=['<ul class="fd-search-menu">'];for(var s=0;s<p;s++){var o=c.autocompleter.response[s];var t=[];for(m in o){if(m!==c.opts.childKey){if(o[m]===""){o[m]="false"}t.push("data-"+m+"="+o[m])}}t=t.join(" ");var n="";for(var r=0,q=c.opts.searchName.length;r<q;r++){if(!!o[c.opts.searchName[r]]){n=c.opts.searchName[r];break}}var m=o[n].split(v).join("<em>"+v+"</em>");u.push('<li  class="fd-item" '+t+">"+m+"</li>")}u.push("</ul>");c.search.autocompleterContain[0].innerHTML=u.join("");c.search.autocompleterContain.removeClass(c.opts.hideAutocompleterClass);if(!c.opts.isAutocompleter){c.search.autocompleterContain.addClass(c.opts.hideAutocompleterClass)}}else{c.search.autocompleterContain.html('<div class="fd-empty-contain">未找到符合条件的数据</div>').removeClass(c.opts.hideAutocompleterClass);c.search.searchInput.removeData();if(!c.opts.isAutocompleter){c.search.autocompleterContain.addClass(c.opts.hideAutocompleterClass)}}},ignoredKeyCod:[9,13,17,19,20,27,33,34,35,36,37,39,44,92,113,114,115,118,119,120,122,123,144,145],bindEvent:function(){c.search.searchInput.off("keydown.autocompleter").on("keydown.autocompleter",c.autocompleter.keydown);c.search.searchInput.off("keyup.autocompleter").on("keyup.autocompleter",c.autocompleter.keyup);c.search.searchInput.off("focus.autocompleter").on("focus.autocompleter",c.autocompleter.focus);c.search.searchInput.off("blur.autocompleter").on("blur.autocompleter",c.autocompleter.blur);c.search.autocompleterContain.off("mousedown.autocompleter").on("mousedown.autocompleter","li",c.autocompleter.mousedown)},keydown:function(k){var j=k.keyCode?k.keyCode:k.which;var l=k.data;if(j===40||j===38){k.preventDefault();k.stopPropagation()}else{if(j===39){}else{if(j===13){k.preventDefault();k.stopPropagation()}}}},search:function(){var j=b.trim(c.search.searchInput.val());if(j!==""){c.autocompleter.response=[];if(c.opts.autocompleterIsAjax){c.autocompleter.query(j,c.opts.data,c.opts.limitCount,true)}else{c.autocompleter.query(j,c.opts.data,c.opts.limitCount);c.autocompleter.makeList(j)}}else{if(!b(c.search.autocompleterContain).hasClass(c.opts.hideAutocompleterClass)){c.autocompleter.hideAutocompleter()}}},focus:function(){c.autocompleter.search()},blur:function(){c.autocompleter.hideAutocompleter();c.search.searchInput.removeData()},keyup:function(m){var n=m.data;var l=m.keyCode?m.keyCode:m.which;if(l===40||l===38){if(b(c.search.autocompleterContain).hasClass(c.opts.hideAutocompleterClass)||b(c.search.autocompleterContain).find("ul").size()<1){return}else{var k=-1;var j=c.search.autocompleterContain.find("."+c.opts.menuSelectedClass);if(j.size()>0){k=j.index()}if(l==40){k++;if(k>=c.autocompleter.response.length){k=0}}else{if(l==38){k--;if(k<0){k=c.autocompleter.response.length-1}}}c.search.autocompleterContain.find("ul").children().removeClass(c.opts.menuSelectedClass).eq(k).addClass(c.opts.menuSelectedClass)}}else{if(b.inArray(l,c.autocompleter.ignoredKeyCod)===-1){if(c.autocompleter.timer){clearTimeout(c.autocompleter.timer);c.autocompleter.timer=null}c.autocompleter.timer=setTimeout(function(){c.autocompleter.search()},c.opts.deferTime)}else{if(l===13){if(!c.search.autocompleterContain.hasClass(c.opts.hideAutocompleterClass)){c.autocompleter.copyValueToSearch();c.search.searchButton.trigger("click.search")}else{c.search.searchButton.trigger("click.search")}}if(c.opts.showLog){console.log("禁用键"+l)}}}},mousedown:function(){c.autocompleter.copyValueToSearch(b(this));c.search.searchButton.trigger("click.search")}};c.scrollBar={range:function(k,j,l){return Math.ceil(Math.min(j,Math.max(k,l)))},stopBubble:function(j){j.stopPropagation();j.preventDefault()},createScrollBar:function(){c.scrollBar.trackContain.html('<span class="'+c.opts.scrollBarClass+'"></span>');c.scrollBar.bar=c.scrollBar.trackContain.find("."+c.opts.scrollBarClass)},hasScroll:false,getParamHeight:function(){c.scrollBar.offsetHeight=c.scrollBar.parentContain.height();c.scrollBar.scrollHeight=c.scrollBar.contentContain.innerHeight();c.scrollBar.trackContainHeight=c.scrollBar.trackContain.innerHeight();var j=c.scrollBar.offsetHeight/c.scrollBar.scrollHeight*c.scrollBar.trackContainHeight;c.scrollBar.barHeight=Math.max(c.opts.scrollBarMinHeight,j);c.scrollBar.scrollMinDistance=0;c.scrollBar.scrollMaxDistance=c.scrollBar.trackContainHeight-c.scrollBar.barHeight;c.scrollBar.hasScroll=c.scrollBar.scrollMaxDistance>0?true:false;c.scrollBar.scrollAreaHeight=c.scrollBar.trackContainHeight-c.scrollBar.barHeight;c.scrollBar.bar.height(c.scrollBar.barHeight);if(c.scrollBar.offsetHeight>c.scrollBar.scrollHeight){c.scrollBar.trackContain.hide()}else{c.scrollBar.trackContain.show()}},update:function(j,l){c.scrollBar.getParamHeight();var m=(b.type(l)=="number")?l:(!parseInt(c.scrollBar.contentContain.css("top"))?0:parseInt(c.scrollBar.contentContain.css("top")));m=Math.abs(m);if((c.scrollBar.scrollHeight-m)<c.scrollBar.offsetHeight){m=c.scrollBar.scrollHeight-c.scrollBar.offsetHeight}var n=m/(c.scrollBar.scrollHeight-c.scrollBar.offsetHeight);if(c.scrollBar.hasScroll){var k=b.type(j)=="number"?j:c.opts.scrollTweenTime;c.scrollBar.bar.stop(true,true).animate({top:c.scrollBar.scrollAreaHeight*n},k);c.scrollBar.contentContain.stop(true,true).animate({top:-Math.round((c.scrollBar.scrollHeight-c.scrollBar.offsetHeight)*n)},k)}else{c.scrollBar.contentContain.css({top:0})}},moveFunction:function(m){if(c.scrollBar.hasScroll){var j=parseInt(c.scrollBar.bar.css("top"))==""?0:parseInt(c.scrollBar.bar.css("top"));j+=Number(m);var k=c.scrollBar.range(j,c.scrollBar.scrollMaxDistance,c.scrollBar.scrollMinDistance);var l=k/c.scrollBar.scrollAreaHeight;c.scrollBar.bar.stop(true,true).animate({top:k},c.opts.scrollTweenTime);c.scrollBar.contentContain.stop(true,true).animate({top:-(c.scrollBar.scrollHeight-c.scrollBar.offsetHeight)*l},c.opts.scrollTweenTime)}else{c.scrollBar.contentContain.css({top:0})}},mousewheel:function(j){c.scrollBar.stopBubble(j);var k=j.deltaY;_moveDistance=0;switch(k){case 1:_moveDistance=c.opts.scrollStep*(-1);c.scrollBar.moveFunction(_moveDistance);break;case -1:_moveDistance=c.opts.scrollStep;c.scrollBar.moveFunction(_moveDistance);break;default:break}},mousedown:function(m){var l=b(this);var n=m.pageY,j=0,k=0;l.addClass(c.opts.pressClass);b(a).on("mousemove.scrollBar",function(o){c.scrollBar.stopBubble(o);k=o.pageY;j=k-n;n=k;c.scrollBar.moveFunction(j)}).on("mouseup.scrollBar",function(){b(a).off("mousemove.scrollBar");b(a).off("mouseup.scrollBar");l.removeClass(c.opts.pressClass)})},resize:function(){c.scrollBar.update(20)},bindEvent:function(){c.scrollBar.parentContain.on("mousewheel.scrollBar",c.scrollBar.mousewheel);c.scrollBar.parentContain.on("mousedown.scrollBar","."+c.opts.scrollBarClass,c.scrollBar.mousedown);b(a).on("resize.scrollBar",c.scrollBar.resize)},unbindEvent:function(){c.scrollBar.parentContain.off("mousewheel.scrollBar",c.scrollBar.mousewheel);c.scrollBar.parentContain.off("mousedown.scrollBar","."+c.opts.scrollBarClass,c.scrollBar.mousedown);b(a).off("resize.scrollBar")},init:function(){c.scrollBar.parentContain=b(c.opts.treeContain);c.scrollBar.parentContain.css({overflow:"hidden"});c.scrollBar.trackContain=c.scrollBar.parentContain.children(c.opts.scrollBarContain),c.scrollBar.contentContain=c._this;c.scrollBar.createScrollBar();c.scrollBar.getParamHeight();c.scrollBar.bindEvent()},destory:function(){c.scrollBar.unbindEvent();c.scrollBar.trackContain.html("")}};c.init();if(c.opts.canSearch){c.autocompleter.bindEvent();c.search.searchButton.off("click.search").on("click.search",function(j){var j=j||a.event;var k=b(j.target);c.search.callback.search(j,k)})}if(c.opts.hasScrollBar){c.scrollBar.init()}return c}}(window,jQuery);
